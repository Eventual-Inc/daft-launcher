cluster_name: daft-aws

provider:
  type: aws
  region: <region>
  cache_stopped_nodes: False

auth:
  ssh_user: ec2-user

max_workers: 2
available_node_types:
  ray.head.default:
    resources: { CPU: 0 }
    node_config:
      InstanceType: <instance_type>
      ImageId: <image_id>

  ray.worker.default:
    min_workers: 2
    max_workers: 2
    resources: {}
    node_config:
      InstanceType: <instance_type>
      ImageId: <image_id>
      IamInstanceProfile:
        Arn: <arn>

setup_commands:
  - curl -LsSf https://astral.sh/uv/install.sh | sh
  - uv python install 3.12.5
  - uv python pin 3.12.5
  - uv venv
  - echo "alias pip='uv pip'" >> $HOME/.bashrc
  - echo "source $HOME/.venv/bin/activate" >> $HOME/.bashrc
  - source $HOME/.bashrc
  - uv pip install "ray[default]==2.36.0" "getdaft>=0.3.2"
